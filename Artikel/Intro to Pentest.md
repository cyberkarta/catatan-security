# Introduction to Pentesting

Short version: https://www.youtube.com/watch?v=5mHr_Tt6pvE

https://www.youtube.com/watch?v=gDqrL20ZTPg


## Nice Subchannel on BHIS
Career mentor
Cert exam help
Seeking menti
Job courts

## Business Process
### Scoping
- Capturing the needs of the organization.
- Defining pentest perimeters, who/what is in scope.
- What to avoid or be cautious about
- Understanding how third-parties can be impacted.
- Clarifying the size or number of resources being tested
- Setting bi-directional expectations

Next?
- Should and always want to confirm
- Understand each test's scope perfectly to avoid trouble.


### Statement of Work (SOW)/Master Service Agreement(MSA)
- Contains scoping, pentest details, and deliveralbles.
- Formal permission to assess the organization.
- Outlines testing logistics.
- Get out of jail free card
- Single snapshot of who, what, why, where, and when

Why do I care?
- Align before testing

### Meetings
Good but optionals
- scoping: understand what's being tested (walk-through)
- Daily stand-ups: what was accomplished and what's next

Important
- Rules of engagement: discuss objectives, pre-reqs, logistics
- Hot-wash: findings discussion at the end of a pentest
- Emergency: critical findings or interruptions to business continuity

### Service Delivery
- Start and stop dates need to be well defined
- Staying within confirmed testing times (9am - 5pm est vs after-hours)
- Understand when to escalate findings/issues
- When successful, permission to re-establish objectives
- Capture evidence, write methodology, track findings
- Minimize post-engagement clean-up by tracking changes
- Keep healthy logs of impactful exploitation
- Stay within the scope

### Hot-washing
 - Doesn't have to be an exhaustive list of findings
 - Focus on high/critical findings and mediums as necessary
 - Highlight positive findings and praise when possible.
 - Provide a couple slides they can leave with
 - Discuss next-steps regarding report delivery.

## Types of Pentest Engagements
### External Network Pentest
- Find and exploit external network vulnerabilities.
- Assess the external perimeter, services, and applications
- Goal is typically to uncover issues that could lead to a breach
- Can sometimes lead to internal network access
- Nowadays can lead to cloud attack paths.
- Usually halts after access is gained or data is obtained.
- May include web apps but not only focus.
- Commonly scoped to IP ranges, subdomains, or domains
- Be careful of domain or subdomain scopes.
- Can be protected by Web Application Firewalls (WAF)

### Internal Network Pentest
- Find and exploit internal network vulnerabilities
- Commonly an Active Directory environment
- Can be considered starting as an assumed breach
- May or may not include a vulnerability scan
- Vulnerabilites usually in misconfigurations not technology
- Usually an objective based assessment
- Great for understanding risks associated with a breached perimeter
- Can be protected by a range of security controls
- Can be monitored by a SOC/MISSP
- Great for growing beyond yearly external pentest
- Great for baselining before a red team

### Red Team Engagement
- Assesses ability to detect, contain, eradicate, and recover
- Avoids detecting and exploiting all vulnerabilities
- Low and slow testing to simulate a motivated attacker.
- Phishing and social engineering in-scope
- Important to tell a story/blend in
- SImulated real-world security incident
- Works to achieve objectives strategically
- Great for organizations with mature security program (SOC/MSSP)
- Great for organizations who have remidiated internal pentest findings.

### Cloud/Container Pentests
- Consider Infrastructure-as-a-Service and Software-as-a-Service
- IaaS is usually one of the big providers: Azure, AWS, GCP
- SaaS is usually one of the big platforms: Gsuite/Workspace, O365
- Exploits over-privileged cloud resources
- Gains access to cloud environments
- Obtaining credentialed access (spraying, SSRF to Metadata, GitHub)
- Compromised resources, source-code, misconfigured storage, etc
- Leveraging third-party access and identity provider implementations
- Container escapes, escalations, kubelet/API, and socket abuse
- Great focused testing for specific tech/app implementations

### WebApp / API Pentests
- uthenticated vs Unauthenticated testing
- Different user-levels (standard user, admin, etc)
- Typically focuses on OWASP Top 10 vulnerabilities
- Check API endpoints for leaking, parameter tampering, access issues.
- Different frameworks are affected by different types of issues
- User to user, user to admin, unauthenticated to user, etc
- Web API commonly tested with mobile apps
- Great to roll pentests into SDLC on major releases

### Mobile App Pentests
- iOS and Android app assessments
- Static and dynamic testing
- Vulnerabilites may be difficult to exploit but are still security issues
- Commonly has statically embedded credentials
- Check for insecure storage, communication, authentication, etc
- iOS can be tricky to test because of jailbreak/app version requirements
- Android can be reversed easily (APK -> Dex -> Jar -> Classes)
- Can test on newer iOS by signing IPA w/ Frida and Passion Fruit
- Can sometimes be included with a web API tests

### Wireless Pentests
- Checks for common wireless issues
- Corporate network vs guest network isolation
- Can you run an evil twin AP? Rogue APs?
- As there authentication security issues? WEP? Weak PSK?
- Wireless networks may have allow-list bypasses
- Assessing wireless client isolation
- Sometimes wireless keyboard/mice can be included
- Leveraging a wireless dropbox can be super useful for remote testing.

### Physical Pentests
- Assessing physical security controls, badged access, and process
- Looks at the environmetn for security related issues
- Examines doors, locks, fences, and unsecured asssets like vehicles
- Exposed badges, clonable, verified badges, etc
- Verifying the ability for an attacker to hitchhike or tailgate
- Commonly has an objective of gaining access to computer equipment
- Sometimes joined with an on-site wireless pentest

### Hardware Pentests
- Specialized testing to analyze hardware device security
- Gaining access to serial interfaces/buses (JTAG, SPI, I2C, UART)
- Changing voltage levels to glitch and disrupt boot process
- Side-channel analysis of power to break cryptography
- Sniffing IoT wireless protocols (zigbee, zwave, BTLE)
- Extracting and reverse engineering firmware
- Bit-flipping DRAM memory to leak data
- Speculative execution side-channel attacks in CPU's
- Not very common

### Social Engineering / Phishing
- Metric-based testing vs spear-phishing to an objective
- Tracking metrics on opening/clock-through/link click/credential captures
- Vishing: making phone calls to unsuspecting targets
- Smishing: sending SMS messages to unsuspecting targets
- Phishing: sending messages to unsuspecting targets (commonly emails)
- Sometimes used to send malicious payloads for establishing C2
- Sometimes used to capture credentials and authenticated sessions
- Very common in red teams for initial access
- Metric testing is great for assessing the usefulness of phishing training
- Phish from social networks, collaboration tools, calendars (not just emails)

## Phases of Methodologies
### Reconnaissance: Passive
![](attachments/Pasted%20image%2020220410142051.png)

### Reconnaissance: Active
![](attachments/Pasted%20image%2020220410142218.png)

### Vulnerability Discovery
![](attachments/Pasted%20image%2020220410142313.png)

### Exploitation
Goal:
- Extract data from the server
- Or gaining access to the server

![](attachments/Pasted%20image%2020220410142359.png)

### Situational Awareness
Am I being monitored?
What do i get access to?

Don't just throwing payload.  

![](attachments/Pasted%20image%2020220410142607.png)

### Persistence
![](attachments/Pasted%20image%2020220410142749.png)

### Pivoting / Lateral Moving
![](attachments/Pasted%20image%2020220410143000.png)


### Escalating
![](attachments/Pasted%20image%2020220410143140.png)

## Reporting
### Overview
![](attachments/Pasted%20image%2020220410143234.png)

### Executive Summary
![](attachments/Pasted%20image%2020220410143321.png)

### Finding: Risk
![](attachments/Pasted%20image%2020220410143343.png)

### Finding: Observation
![](attachments/Pasted%20image%2020220410143429.png)

### Finding: Discussion
![](attachments/Pasted%20image%2020220410143459.png)

### Finding: Recommendation
![](attachments/Pasted%20image%2020220410143520.png)

### Methodology
![](attachments/Pasted%20image%2020220410143545.png)

### Scope/Data Archives
![](attachments/Pasted%20image%2020220410143636.png)

## Building Experiences
- ctf101.org
- ctftime.org
- holidayhackchallenge sans

