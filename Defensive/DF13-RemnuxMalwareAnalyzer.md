Remnux virtual appliance


trid -> file identifiers to determine filetype of malware

Steps:
1. Examine static properties to assess the natures of the malware, the characteristics, what is dangerous.
2. Statically analyze the code -> identify malicious capabilities
3. Explore network interactions -> behavior (run the malware)

## Examine Static Properties
- file sample.exe (get the file type and metadata)
- yara-rules sample.exe
- clamscan sample.exe (anti-virus)
- signsrch sample.exe (to deal with cryptographic signature)

Others
- peframe sample.txt (hashes, sections code and .rsrc, suspicious API references + scan with yara rules) (hasoverlay? malware)
- pecheck (general permission about file, risky API calls, overlay metadata)
	- pecheck -g o -D sample.exe > sample.exe.overlay (extract strings) (strings --encoding-l sample.exe.overlay)

Deobfuscation
- xorsearch (if attacker using xor to obfuscate), contoh xorsearch sample.exe http
- brxor (testing using english dictionary) - more automated than xorsearc, contoh brxor.py sample.exe
- bbcrack sample.exe (scanning, need time)
- floss --no-static-strings sample.exe (the most powerful, it can deobfuscate strings that concealed using algorithms - emulates the execution of the program, and detect the change in the memory)

Strings, hash values and other properties are helpful for IOCs
Deobfuscated strings reveal sensitive data and API references
Use your findings as the basis for OSINT to expand your perspective
Observations at this point are theories for validating later.

## Statically Analyze Code
- binee sample.exe: use code emulators to pretend to run the program and interact with the environment (files, registry key, and other programs)
- qltool run --rootfs rootfs/x86_windows/ -f sample.exe > ql_out (run the malware and look at the log)
- capaa -vv sample.exe (simulates to run program and look at the risky activity)
- decompiler using docker : docker run -it --rm -v ~/:tmp/files remnux/retdec bash
	- retdec-decompiler.py sample.exe
- more sample.exe
- Ghidra -> reverse engineer

Malware some designed to detect sandbox program

Anti analysis = GetTickCount, GetCursorPosition, and GetForegroundWindow.

## Explore Networks Interactions
Infect a windows lab system with sample.exe on the same isolated network as the REMnuxVM
- renew-dhcp
- fakedns
- wireshark
- inetsim
- 
## Research
Overlay malware?
PECompact2(search) -> packer to conceal the original code to malware analyst.
api name on windows

## Reference
- [Analyzing Windows Malware on Linux: Getting Started Tips and Examples](https://www.youtube.com/watch?v=J85991pPYoc)
- 